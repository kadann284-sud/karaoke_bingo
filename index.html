<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã‚«ãƒ©ã‚ªã‚±ãƒ“ãƒ³ã‚´</title>

  <style>
    body {
      font-family: "Segoe UI", system-ui, sans-serif;
      background: linear-gradient(135deg, #1e1e2f, #2b2b45);
      color: #fff;
      margin: 0;
      padding: 16px;
    }

    h1 {
      text-align: center;
      margin-bottom: 8px;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    .controls,
    .description,
    .conditions-box {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 12px;
    }

    .controls input {
      width: 100%;
      padding: 8px;
      margin-bottom: 8px;
      border-radius: 8px;
      border: none;
    }

    button {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: bold;
      background: linear-gradient(135deg, #ff7a18, #ffb347);
      color: #000;
      cursor: pointer;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 12px;
    }

    td {
      height: 150px;
      border-radius: 18px;
      text-align: center;
      font-weight: bold;
      font-size: 26px;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
    }

    td.marked {
      background: #00e676 !important;
      color: #000;
    }

    .range {
      display: block;
      font-size: 12px;
      font-weight: normal;
      margin-top: 4px;
    }

    /* ã‚«ãƒ†ã‚´ãƒªè‰² */
    .cat-release {
      background: #ff8a80;
    }

    .cat-title {
      background: #82b1ff;
    }

    .cat-lang {
      background: #b9f6ca;
    }

    .cat-artist {
      background: #ffd180;
    }

    .cat-other {
      background: #e1bee7;
    }

    /* ãƒ¢ãƒ¼ãƒ€ãƒ« */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      display: none;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: #fff;
      color: #000;
      padding: 24px 32px;
      border-radius: 16px;
      font-size: 32px;
      font-weight: bold;
    }

    /* è¿½åŠ ï¼šæ¡ä»¶ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç”¨ */
    .conditions-box ul {
      margin: 8px 0 0;
      padding-left: 18px;
    }

    .conditions-box li {
      margin: 6px 0;
      list-style: none;
    }

    .cond-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .cond-row input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: #ffb347;
      cursor: pointer;
    }

    .cond-note {
      opacity: 0.85;
      font-size: 12px;
      margin-top: 8px;
    }
  </style>
</head>

<body>
  <h1>ğŸ¤ ã‚«ãƒ©ã‚ªã‚±ãƒ“ãƒ³ã‚´</h1>

  <div class="description">
    <p>
      é–‹å§‹ç‚¹æ•°ã¨ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã€äººæ•°ã‚’å…¥åŠ›ã—ã¦ãƒ“ãƒ³ã‚´ç”Ÿæˆã€‚<br>
      æ¡ä»¶ã¨ç‚¹æ•°ãŒä¸€è‡´ã—ãŸã‚‰ãƒã‚¹ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚
    </p>

    <br>

    <p style="font-size: 20px; font-weight: bold;">
      ã‚«ãƒ©ã‚ªã‚±ãƒ“ãƒ³ã‚´ã®ãƒ«ãƒ¼ãƒ«
    </p>

    <p>
      1. ä»»æ„ã®ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆã‚’3ã¤ã¨é–‹å§‹ç‚¹æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br>
      2. ã€Œãƒ“ãƒ³ã‚´ã‚’ç”Ÿæˆã€ã‚’æŠ¼ã™ã¨ã€é–‹å§‹ç‚¹æ•°ã‹ã‚‰+10ç‚¹ã¾ã§ã®ç¯„å›²ã§ãƒã‚¹ãŒãƒ©ãƒ³ãƒ€ãƒ ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚<br>
      3. è‡ªåˆ†ãŒæ­Œã£ãŸæ›²ã‚„ä»–ã®äººãŒæ­Œã£ãŸæ›²ã§ã€ãƒã‚¹ã®æ¡ä»¶ã«å½“ã¦ã¯ã¾ã£ãŸå ´åˆã¯ã€è©²å½“ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒãƒ¼ã‚¯ã—ã¦ãã ã•ã„ã€‚<br>
      4. ä»–ã®äººãŒã™ã§ã«æ­Œã£ãŸæ›²ã¯ã€åŒã˜æ›²ã‚’ã‚‚ã†ä¸€åº¦æ­Œã†ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚<br>
      5. æ¡ä»¶ãƒªã‚¹ãƒˆã¯å³å´ã§ãƒ“ãƒ³ã‚´ç”Ÿæˆå‰ã«ç¢ºèªã§ãã¾ã™ã€‚
    </p>
  </div>


  <div class="container">
    <div class="controls">
      <input id="artist1" placeholder="ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ1">
      <input id="artist2" placeholder="ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ2">
      <input id="artist3" placeholder="ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ3">

      <label>é–‹å§‹ç‚¹æ•°ï¼ˆç‚¹ï¼‰</label>
      <input id="startScore" type="number" value="80">

      <label>éŠã¶äººæ•°ï¼ˆäººï¼‰</label>
      <input id="playerCount" type="number" min="1" value="2">


      <button onclick="generateBingo()">ãƒ“ãƒ³ã‚´ç”Ÿæˆ</button>
    </div>

    <div class="conditions-box" id="preConditions">
      <strong>æ¡ä»¶ãƒªã‚¹ãƒˆ</strong>
      <ul id="conditionList"></ul>
      <div class="cond-note">â€»ã€Œâ˜‘ã‚’å¤–ã™ã¨ç„¡ã—ã€ã«ã§ãã‚‹ã®ã¯ã€ä»Šå›è¿½åŠ ã—ãŸæ¡ä»¶ã ã‘ã§ã™ã€‚</div>
    </div>

    <table id="bingo"></table>
  </div>

  <div class="modal" id="bingoModal">
    <div class="modal-content">ãƒ“ãƒ³ã‚´ï¼</div>
  </div>

  <script>
    const GYO = ["ã‚", "ã‹", "ã•", "ãŸ", "ãª", "ã¯", "ã¾", "ã‚„", "ã‚‰", "ã‚"];
    const DAN = ["ã‚", "ã„", "ã†", "ãˆ", "ãŠ"];

    const baseConditions = [
      { name: "ã‚¢ãƒƒãƒ—ãƒ†ãƒ³ãƒ", cat: "cat-other" },
      { name: "ãƒãƒ©ãƒ¼ãƒ‰", cat: "cat-other" },
      { name: "ä¸€äººã ã‘çŸ¥ã‚‰ãªã„æ›²", cat: "cat-other" },
      { name: "2015â€“2017å¹´ãƒªãƒªãƒ¼ã‚¹", cat: "cat-release" },
      { name: "2018â€“2020å¹´ãƒªãƒªãƒ¼ã‚¹", cat: "cat-release" },
      { name: "2021â€“2023å¹´ãƒªãƒªãƒ¼ã‚¹", cat: "cat-release" },
      { name: "2024å¹´ä»¥é™ã®ãƒªãƒªãƒ¼ã‚¹", cat: "cat-release" },
      { name: "æ›²åæ¼¢å­—ã®ã¿", cat: "cat-title" },
      { name: "æ›²åè‹±èªã®ã¿", cat: "cat-title" },
      { name: "æ›²åã‚«ã‚¿ã‚«ãƒŠã®ã¿", cat: "cat-title" },
      { name: "æ—¥æœ¬èªã§8æ–‡å­—ä»¥ä¸Šã®æ›²", cat: "cat-lang" },
      { name: "æ—¥æœ¬èªã§2æ–‡å­—ä»¥ä¸‹ã®æ›²", cat: "cat-lang" },
      { name: "ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåãŒã€‡è¡Œ or â–¡æ®µ", cat: "cat-artist" },
      { name: "æ›²åãŒã€‡è¡Œ or â–¡æ®µ", cat: "cat-title" },

      // ===== è¿½åŠ æ¡ä»¶ï¼ˆâ˜‘ã§ç„¡ã—ã«ã§ãã‚‹ï¼‰ =====
      { name: "â—¯äººãƒãƒ³ãƒ‰ï¼ˆã€‡ã¯3ï½5ï¼‰", cat: "cat-other", optional: true, optId: "opt_band" },
      { name: "å¤±æ‹ã‚½ãƒ³ã‚°", cat: "cat-other", optional: true, optId: "opt_breakup" },
      { name: "å¤ã®æ­Œ(éåŠæ•°ãŒå¤ã ã¨æ€ã£ãŸã‚‰OK)", cat: "cat-other", optional: true, optId: "opt_summer" },
      { name: "å†¬ã®æ­Œ(éåŠæ•°ãŒå†¬ã ã¨æ€ã£ãŸã‚‰OK)", cat: "cat-other", optional: true, optId: "opt_winter" },
      { name: "ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ã®æ›²", cat: "cat-other", optional: true, optId: "opt_disney" },
      { name: "ä¸»é¡Œæ­Œ", cat: "cat-other", optional: true, optId: "opt_theme" },
    ];

    function renderConditionList() {
      const ul = document.getElementById("conditionList");
      ul.innerHTML = "";

      baseConditions.forEach(c => {
        const li = document.createElement("li");

        // è¿½åŠ åˆ†ã ã‘ã€Œâ˜‘ã§ç„¡ã—ã€ã‚’ä»˜ã‘ã‚‹
        if (c.optional) {
          const row = document.createElement("div");
          row.className = "cond-row";

          const cb = document.createElement("input");
          cb.type = "checkbox";
          cb.id = c.optId;
          cb.checked = true;

          const label = document.createElement("label");
          label.htmlFor = c.optId;
          label.textContent = c.name;

          row.appendChild(cb);
          row.appendChild(label);
          li.appendChild(row);
        } else {
          li.textContent = c.name;
        }

        ul.appendChild(li);
      });
    }
    renderConditionList();

    function rand(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }

    function generateBingo() {
      document.getElementById("preConditions").style.display = "none";
      const table = document.getElementById("bingo");
      table.innerHTML = "";

      const start = Number(startScore.value);
      const playerCount = Number(document.getElementById("playerCount").value);

      let conditions = [...baseConditions];

      // è¿½åŠ åˆ†ï¼šâ˜‘ã‚’å¤–ã—ãŸæ¡ä»¶ã¯é™¤å¤–
      conditions = conditions.filter(c => {
        if (!c.optional) return true;
        const cb = document.getElementById(c.optId);
        return cb ? cb.checked : true;
      });

      // å°‘äººæ•°æ™‚ã®æ¡ä»¶å‰Šé™¤
      if (playerCount <= 2) {
        conditions = conditions.filter(c => c.name !== "ä¸€äººã ã‘çŸ¥ã‚‰ãªã„æ›²");
      }

      /* ===============================
         ãƒãƒ©ãƒ¼ãƒ‰ / ã‚¢ãƒƒãƒ—ãƒ†ãƒ³ãƒåˆ¶å¾¡
         =============================== */
      const tempoConditions = conditions.filter(
        c => c.name === "ãƒãƒ©ãƒ¼ãƒ‰" || c.name === "ã‚¢ãƒƒãƒ—ãƒ†ãƒ³ãƒ"
      );

      // ã©ã¡ã‚‰ã‹ä¸€æ–¹ã‚’å¿…ãšé¸ã¶
      const selectedTempo = rand(tempoConditions);

      // ä¸¡æ–¹ã¯å…¥ã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹
      conditions = conditions.filter(
        c => c.name !== "ãƒãƒ©ãƒ¼ãƒ‰" && c.name !== "ã‚¢ãƒƒãƒ—ãƒ†ãƒ³ãƒ"
      );
      conditions.push(selectedTempo);

      /* ===============================
         å¹´ãƒªãƒªãƒ¼ã‚¹æ¡ä»¶ã¯æœ€å¤§2ã¤ã¾ã§
         =============================== */
      const releaseConditions = conditions.filter(c =>
        c.name.includes("ãƒªãƒªãƒ¼ã‚¹")
      );

      const otherConditions = conditions.filter(
        c => !c.name.includes("ãƒªãƒªãƒ¼ã‚¹")
      );

      const selectedReleases = releaseConditions
        .sort(() => Math.random() - 0.5)
        .slice(0, 2);

      conditions = [...otherConditions, ...selectedReleases];

      /* ===============================
         9ãƒã‚¹åˆ†ãã‚ãˆã‚‹
         =============================== */
      while (conditions.length < 9) {
        conditions.push(rand(conditions));
      }

      conditions = conditions.sort(() => Math.random() - 0.5).slice(0, 9);

      let idx = 0;
      for (let r = 0; r < 3; r++) {
        const tr = table.insertRow();
        for (let c = 0; c < 3; c++) {
          const td = tr.insertCell();
          const cond = conditions[idx++];

          let name = cond.name;

          // æ—¢å­˜ï¼šè¡Œ/æ®µã®åŸ‹ã‚è¾¼ã¿
          if (name.includes("ã€‡è¡Œ")) {
            name = name.replace("ã€‡", rand(GYO)).replace("â–¡", rand(DAN));
          }

          // è¿½åŠ ï¼šâ—¯äººãƒãƒ³ãƒ‰ï¼ˆ3ï½5ï¼‰
          if (name.includes("â—¯äººãƒãƒ³ãƒ‰")) {
            const n = 3 + Math.floor(Math.random() * 3); // 3,4,5
            name = name.replace("â—¯", String(n));
          }

          const score = start + Math.floor(Math.random() * 11);
          td.className = cond.cat;
          td.innerHTML = `
        ${score}ç‚¹
        <span class="range">${(score - 1).toFixed(2)}ï½${(score + 0.99).toFixed(2)}</span>
        <div style="font-size:14px">${name}</div>
      `;

          td.onclick = () => {
            td.classList.toggle("marked");
            checkBingo();
          };
        }
      }
    }


    function checkBingo() {
      const t = document.getElementById("bingo");
      const lines = [
        [[0, 0], [0, 1], [0, 2]],
        [[1, 0], [1, 1], [1, 2]],
        [[2, 0], [2, 1], [2, 2]],
        [[0, 0], [1, 0], [2, 0]],
        [[0, 1], [1, 1], [2, 1]],
        [[0, 2], [1, 2], [2, 2]],
        [[0, 0], [1, 1], [2, 2]],
        [[0, 2], [1, 1], [2, 0]],
      ];

      if (lines.some(line =>
        line.every(([r, c]) => t.rows[r].cells[c].classList.contains("marked"))
      )) {
      }
    }
  </script>
</body>

</html>
